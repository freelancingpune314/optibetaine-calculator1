import { Component, OnInit } from '@angular/core';
import { DataService } from '../data.service';
import { Router } from '@angular/router';

@Component({
  selector: 'app-results',
  templateUrl: './results.component.html',
  styleUrls: ['./results.component.scss']
})
export class ResultsComponent implements OnInit{

  requiredTablets = 0;

  boilerVal: any = {
    "1": "52.5",
    "2": "63",
    "3": "77",
    "4": "87.5",
    "5": "105",
    "6": "115.5",
    "7": "129.5",
    "8": "140",
    "9": "154",
    "10": "164.5",
    "11": "182",
    "12": "192.5",
    "13": "206.5",
    "14": "220.5",
    "15": "245",
    "16": "259",
    "17": "273",
    "18": "287",
    "19": "301",
    "20": "315",
    "21": "332.5",
    "22": "360.5",
    "23": "385",
    "24": "409.5",
    "25": "430.5",
    "26": "455",
    "27": "479.5",
    "28": "490",
    "29": "504",
    "30": "514.5",
    "31": "525",
    "32": "535.5",
    "33": "549.5",
    "34": "560",
    "35": "574",
    "36": "602",
    "37": "626.5",
    "38": "651",
    "39": "682.5",
    "40": "703.5",
    "41": "731.5",
    "42": "745.5",
  };

  layerVal: any =  {
    "1": "38.5",
    "2": "56",
    "3": "63",
    "4": "87.5",
    "5": "122.5",
    "6": "140",
    "7": "154",
    "8": "168",
    "9": "171.5",
    "10": "175",
    "11": "178.5",
    "12": "189",
    "13": "196",
    "14": "203",
    "15": "210",
    "16": "217",
    "17": "220.5",
    "18": "231",
    "19": "262.5",
    "20": "287",
    "21": "315",
    "22": "325.5",
    "23": "336",
    "24": "357",
    "25": "364",
    "26": "371",
    "27": "378",
    "28": "378",
    "29": "381.5",
    "30": "388.5",
    "31": "388.5",
    "32": "402.5",
    "33": "402.5",
    "34": "402.5",
    "35": "402.5",
    "36": "402.5",
    "37": "399",
    "38": "399",
    "39": "399",
    "40": "395.5",
    "41": "395.5",
    "42": "395.5",
    "43": "395.5",
    "44": "395.5",
    "45": "395.5",
    "46": "395.5",
    "47": "395.5",
    "48": "395.5",
    "49": "395.5",
    "50": "392",
    "51": "392",
    "52": "392",
    "53": "392",
    "54": "392",
    "55": "392",
    "56": "392",
    "57": "392",
    "58": "392",
    "59": "392",
    "60": "392",
    "61": "385",
    "62": "385",
    "63": "385",
    "64": "385",
    "65": "385",
    "66": "385",
    "67": "385",
    "68": "385",
    "69": "385",
    "70": "385",
    "71": "385",
    "72": "385"
  };

  breederVal: any = {
    "1": "80.5",
    "2": "101.5",
    "3": "122.5",
    "4": "140",
    "5": "154",
    "6": "164.5",
    "7": "171.5",
    "8": "178.5",
    "9": "182",
    "10": "185.5",
    "11": "189",
    "12": "196",
    "13": "203",
    "14": "213.5",
    "15": "231",
    "16": "252",
    "17": "280",
    "18": "308",
    "19": "332.5",
    "20": "357",
    "21": "374.5",
    "22": "385",
    "23": "395.5",
    "24": "406",
    "25": "409.5",
    "26": "490",
    "27": "546",
    "28": "546",
    "29": "546",
    "30": "546",
    "31": "546",
    "32": "546",
    "33": "546",
    "34": "546",
    "35": "539",
    "36": "539",
    "37": "539",
    "38": "539",
    "39": "539",
    "40": "539",
    "41": "539",
    "42": "532",
    "43": "532",
    "44": "532",
    "45": "532",
    "46": "532",
    "47": "532",
    "48": "532",
    "49": "532",
    "50": "532",
    "51": "525",
    "52": "525",
    "53": "525",
    "54": "525",
    "55": "525",
    "56": "525",
    "57": "525",
    "58": "525",
    "59": "525",
    "60": "525",
    "61": "518",
    "62": "518",
    "63": "518",
    "64": "518",
    "65": "518",
    "66": "518"
  }




  constructor(private router: Router, public dataService: DataService) {}

  ngOnInit(): void {
    this.calculateTablets();
  }

  calculateTablets() {
    let waterLevelArr = 0;
    let refToJsonVal;
    if(this.dataService.birdType == 'Broiler') {
      refToJsonVal = this.boilerVal;
    } else if(this.dataService.birdType == 'Layer') {
      refToJsonVal = this.layerVal;
    } else {
      refToJsonVal = this.breederVal;
    }

    for(let day in this.boilerVal) {
      if(day >= this.dataService.fromDate && day <= this.dataService.toDate) {
        waterLevelArr = waterLevelArr + Number(this.boilerVal[day]);
      }
    }

    this.requiredTablets = (waterLevelArr * 0.40) * this.dataService.birdsCount / 1000;
    this.requiredTablets = Math.round(this.requiredTablets / 100);

  }

  goBack() {
    // Navigate to previous screen
    this.router.navigate(['/farm-details']); // Adjust as needed
  }

  goHome() {
    this.router.navigate(['']);
  }
}
